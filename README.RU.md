[![EN](https://user-images.githubusercontent.com/9499881/33184537-7be87e86-d096-11e7-89bb-f3286f752bc6.png)](https://github.com/r57zone/DualShock4-emulator/) 
[![RU](https://user-images.githubusercontent.com/9499881/27683795-5b0fbac6-5cd8-11e7-929c-057833e01fb1.png)](https://github.com/r57zone/DualShock4-emulator/blob/master/README.RU.md)
[![FR](https://user-images.githubusercontent.com/9499881/147121779-f90bdadf-8009-4dc4-8682-f15f4bd2008e.png)](https://github.com/r57zone/DualShock4-emulator/blob/master/README.FR.md)

# DualShock4 эмулятор
Простое приложение для эмуляции геймпада Sony DualShock 4, с помощью Xbox контроллера или клавиатуры и мыши. Данный способ необходим для полноценной работы сервиса [Sony Playstation Plus](https://www.playstation.com/en-us/ps-plus/) или [Playstation Remote Play](https://www.playstation.com/remote-play/). Работает на базе драйвера [ViGEm](https://github.com/ViGEm).

## Настройка
1. Установить [ViGEmBus](https://github.com/ViGEm/ViGEmBus/releases).
2. Установите [Microsoft Visual C++ Redistributable 2017](https://learn.microsoft.com/cpp/windows/latest-supported-vc-redist) или новее.
3. Распаковать и запустить DualShock4 emulator (**Внимание!** Важно запускать DS4 emulator до запуска PS Plus, если вы используете Xbox контроллер, чтобы PS Plus отдала приоритет DualShock контроллеру).
4. Запустите "PlayStation Plus", "PS Remote Play", "xCloud" или другое приложение. Для настройки xCloud прочтите FAQ.
5. При необходимости можно инвертировать оси, измените параметры `InvertX` и `InvertY` на `1`, в конфигурационном файле "Config.ini".
6. Также можно проверить как работает эмуляция контроллера DualShock 4 в программе [VSCView](https://github.com/Nielk1/VSCView/releases/).
7. Изучите конфигурационный `Config.ini` и описание ниже, возможно что-то можно настроить более удобно.

## ЧаВо
**• Программа вылетает после запуска**<br>
"Антивирус" блокирует динамическую загрузку библиотеки Xbox геймпадов, поэтому программа падает. Можно на время использования закрыть его.



**• Нажатие тачпада не работает**<br>
Возможно, что приложения "PS Plus" или "PS Remote Play" отдали приоритет контроллеру Xbox, поэтому перезапустите приложения "PS Plus" или "PS Remote Play" и эмулируемый DualShock 4 должен получить приоритет над Xbox контроллером.



**• При игре в xCloud, в браузере, на правую кнопку мыши вызывается контекстное меню, как убрать его в браузере?**<br>
Сначала изменить название окна в конфигурационном файле или изменить параметр `ActivateInAnyWindow` на `1`, перезапустие программу. Далее зайдите на сайт xCloud, нажмите "F12", выберите консоль и вставьте [этот код](https://github.com/r57zone/DualShock4-emulator/blob/master/ContextMenuBlock.txt) туда, нажмите запустить и контекстное меню больше не будет показываться.



• **Игра видит 2 геймпада одновременно (DualSense / DualShock 4 / Nintendo Pro контроллер или JoyCon-ы и Xbox)**<br>
Скрыть свой геймпад можно, с помощью программы [HidHide](https://github.com/ViGEm/HidHide).

## Xbox контроллер
Кнопка `Назад/Просмотр/Выбор` (первая кнопка справа от левого стика) на Xbox контроллере эмулирует нажатие тачпада на Sony DualShock 4.

Кнопка `Поделиться` привязана на одновременное нажатие кнопок `Назад/Просмотр/Выбор` и `Старт/Меню` и на клавишу `F12`.

Кнопка `PS` привязана на кнопку `Xbox`, но для её использования нужно в настройках "Xbox Game Bar" отключить использованией этой кнопки. Также кнопка "PS" привязана на одновременное нажатие кнопок "Назад/Просмотр/Выбор" и "LB" (левый бампер) или на клавишу "F2".

Потрясти геймпад (гироскоп) можно нажав `Back + RB` (правый бампер). 


Вращать геймпад (гироскоп) можно нажав `Back` и `DPAD ←↑↓→` (изменить сочетания можно в конфигурационном файле).


При необходимости можно обменять местами бамперы и триггеры, а также кнопку "поделится" и нажатие тачпада, для этого в конфигурационном файле "Config.ini" нужно изменить параметр `SwapTriggersShoulders` или `SwapShareTouchPad` на `1`.



Поддерживается изменение мёртвой зоны стиков для дрейфующих стиков. Нажмите `ALT + F9` для получения значений, вставьте их в конфигурационный файле "Config.ini", в параметры `DeadZone` и перезапустите программу.

## Тачпад
Игра | Действие
------------ | -------------
Uncharted 3: Иллюзии Дрейка (2011) | Кнопка `Share` (F12) дублирует нажатие левой части тачпада.
Одни из нас. Часть II (2020) | Можно заменить нажатие тачпада кнопками. Параметры -> Доступность -> "Настройки бренчания" вместо вертикальной и горизонтальной ставим кнопки.

На Xbox геймпаде необходимо нажать кнопку `Назад/Просмотр/Выбор` (тачпад) и двигать стик в стороны для свайпов. По умолчанию нажатие тачпада при свайпах выключено, его можно включить в конфигурационном файле, изменив параметр `TouchPadPressedWhenSwiping` на `1`.



Для клавиатуры можно использовать свайпы, коды кнопок описаны ниже.

## Движения, с помощью Android телефона (гироскоп)
1. Включите в конфигурационном файле `Config.ini` параметр `Activate`, изменив `0` на `1`, в разделе `Motion`.
2. Проверьте брандмауэр Windows, разрешены ли входящие подключения у вашего типа сети (частной) и разрешите если отключены. 
3. Установите FreePieIMU на ваш Android телефон, взяв последнюю версию в архиве [OpenTrack](https://github.com/opentrack/opentrack) или в [релизах](https://github.com/r57zone/DualShock4-emulator/releases), введите IP адрес вашего компьютера, отметьте пункт "Send raw data", если не отмечен, выберите скорость передачи данных "Fastest" или "Fast".
4. При необходимости уменьшите общую чувствительность (параметр Sens в разделе `Motion`, где `100` — 100% чувствительность), в конфигурационном файле.
5. При необходимости уменьшите чувствительность отдельных датчиков (`AccelSens` и `GyroSense` в разделе `Motion`, где `100` — 100% чувствительность), в конфигурационном файле.
6. При необходимости инвертируйте оси (параметры `InverseX`, `InverseY` и `InverseZ`, в секции `Motion`, где `1` включает инверсию, а `0` выключает).
7. Измените ориентацию телефона (параметр `Ориентация` в разделе `Motion`, где `1` — альбомная, а `0` — портретная).

Если в игре нужно просто потрести (гироскоп) геймпад, то нет необходимости в установке приложений для Android, просто нажмите кнопку "тряски" геймпада.

## Клавиатура и мышь
По умолчанию мышь и клавиатура работает только в окнах "PlayStation Plus" и "PS4 Remote Play" (измените параметр `ActivateOnlyInWindow2` на региональный заголовок приложения, например "Дистанционное воспроизведение PS4"). Для работы только в каких-либо других приложениях или эмуляторах измените параметры `ActivateOnlyInWindow` и `ActivateOnlyInWindow2` на заголовки этих приложений. Можно включить работу во всех окнах (измените параметр `ActivateInAnyWindow` на `1`, в конфигурационном файле "Config.ini") или измените название окна (параметр `ActivateOnlyInWindow`), в котором захватываются действия. Это необходимо, чтобы курсор центрировался только в одном окне и не нажимались кнопки при свёрнутом окне.

Для отключения центрирования курсора зажмите кнопку "C" (можно изменить в конфиге - `StopСenteringKey`).

Для скрытия курсора при запуске измените `HideCursorAfterStart` на `1`, чтобы восстановить курсор, закройте программу нажав "ALT" + "ESCAPE" или "~". 

Для полноэкранного режима Playstation Plus используйте клавиши "ALT" + "F10", верхняя черная полоса, а также панель задач будут скрыты. Для того, чтобы вернуть обычное окно нажмите эти клавиши снова. Отключить скрытие панели задач можно в конфигурационном файле, изменив параметр `HideTaskBarInFullScreen` на `0`. В случае если окно Playstation Plus однажды изменится, то можно изменить смещение сверху по умолчанию, параметр `FullScreenTopOffset`.

DualShock 4 | Клавиатура и мышь
------------ | -------------
L1 | Alt
R1 | Control
L2 | Правая кнопка мыши
R2 | Левая кнопка мыши
SHARE | F12
TOUCHPAD (нажатие тачпада) | Enter
OPTIONS | Tab
DPAD UP (стрелка вверх) | 1
DPAD LEFT (стрелка влево) | 2
DPAD RIGHT (стрелка вправо) | 3
DPAD DOWN (стрелка вниз) | 4
TRIANGLE (треугольник) | E
SQUARE (квадрат) | R
CIRCLE (круг) | Q
CROSS (крестик) | Space
L3 (нажатие стика) | Shift
R3 (нажатие стика) | Средняя кнопка мыши
Touchpad свайп вверх, вниз, влево, вправо | 7, 8, 9, 0
Touchpad вверх, вниз, влево, вправо, вниз  | U, J, H, K, N
Потрясти геймпад | T
Повернуть геймпад вперед, назад, вправо, влево (гироскоп) | Numpad 8, 2, 4, 6
PS | F2

В конфигурационном файле профиля, в папке "Profiles", можно изменить привязки кнопок или создать новый на основе `Default.ini`. Название кнопок можно найти [здесь](https://github.com/r57zone/DualShock4-emulator/blob/master/BINDINGS.RU.md). Можно выбрать из стандартных профилей. Присылайте более удобные привязки для разнообразных игр.



Параметры чувствительности `SensX`, `SensY` для мыши можно также найти в конфигурационном файле, в разделе "Mouse". При отсуствии движения стика можно попробовать увеличить параметр "SleepTimeOut" до 2, 4, 8, 10.



Также можно включить эмуляцию аналоговых триггеров (L2, R2), измените параметр `EmulateAnalogTriggers` на `1` и шаг увеличения `AnalogTriggerStep` (от 0.1 до 255).

## Загрузка
>Версия для Windows 10, 11.

**[Загрузить](https://github.com/r57zone/DualShock4-emulator/releases)**

## Обратная связь
`r57zone[собака]gmail.com`